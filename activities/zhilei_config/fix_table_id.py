from tools.txtTableRead.get_table_data import get_table_list_data, write_table_data, get_table_data, get_tp_id_name


def insert_at(d, position, key, value):
    """通用的字典位置插入函数"""
    items = list(d.items())
    items.insert(position, (key, value))
    return dict(items)

table_key_list=[
    'ABTEST',
    'ACHIEVEMENT_CATEGORY',
    'ACHIEVEMENT_GROUP',
    'ACHIEVEMENT_GROUP_REWARDS',
    'ACHIEVEMENT_WANTED',
    'ACTION_STATE',
    'ACTIVITY_BIND_PHONE',
    'ACTIVITY_CENTER',
    'ACTIVITY_DOUBLE_WEEK',
    'ACTIVITY_DOUBLE_WEEK_RANK_REWARD',
    'ACTIVITY_NEW_YEAR_BET_WEIGHT',
    'ACTIVITY_NEW_YEAR_TENSION_SPAN',
    'ACTIVITY_REBRAND_MOONCAKE',
    'ACTIVITY_SIGN_MAY_DAY',
    'ACTIVITY_TARGET_CLOVER_RANDOM',
    'ACTIVITY_TARGET_FISH',
    'ACTIVITY_WORD_COLLECT_EXCHANGE',
    'ACTIVITY_WORD_COLLECT_MAIN',
    'ACTIVITY_WORD_COLLECT_SHOW_ITEM',
    'ACTIVITY_WORD_COLLECT_WORD_ITEM',
    'ADVERTS',
    'ADVERTS_DOMESTIC',
    'ADV_GEAR_FISHING_GEAR',
    'ADV_GEAR_FISHING_GEAR_SHARDS',
    'ADV_GEAR_FISHING_ROD',
    'ADV_GEAR_QUALITY',
    'ADV_GEAR_STAR',
    'ADV_GEAR_SUITE',
    'ADV_LEVEL_UP',
    'ADV_ROD_MAIN',
    'ADV_ROD_QUALITY',
    'AD_GENERAL_RULES',
    'AD_LAYER_CHARGE_TYPE',
    'AD_REWARD',
    'AD_ROULETTE',
    'ALLOT_CONFIG',
    'ANNIVERSARY',
    'ANNIVERSARY_YEARLY_MEMORIE_EVENT',
    'ANNIVERSARY_YEARLY_MEMORIE_MAIN',
    'ANNIVERSARY_YEARLY_MEMORIE_PAGE',
    'ANNOUNCEMENT',
    'AQUARIUM',
    'AQUARIUM_LV',
    'AQUARIUM_MFISH',
    'AQUARIUM_NEW_FISH_SHOW',
    'AQUARIUM_NEW_GOODS',
    'AQUARIUM_NEW_GROW',
    'AQUARIUM_NEW_LEVEL',
    'AQUARIUM_NEW_MISSION',
    'AQUARIUM_NEW_MISSION_RANK',
    'AQUARIUM_NEW_SETTING',
    'AQUARIUM_NEW_SHOP',
    'AQUARIUM_NEW_SKIN',
    'AQUARIUM_NEW_SLOT',
    'AQUARIUM_OFISH',
    'AQUARIUM_SKIN',
    'AQUARIUM_SLOT',
    'AQUARIUM_SLOT_LV',
    'ARCHERYMAPINFO',
    'ATTR_GROUP',
    'ATTR_NAME',
    'AVATAR_ACCESS_WAYS',
    'BAIT',
    'BAIT_SHARDS',
    'BAIT_STAR',
    'BAIT_UP',
    'BATTLE_BUFF',
    'BATTLE_NOTICE',
    'BATTLE_PASS',
    'BATTLE_PASS_MAIN',
    'BATTLE_PASS_MAIN_2024',
    'BATTLE_SKILL',
    'BLOCK_DRAW_MAIN',
    'BLOCK_DRAW_REWARD',
    'BLOCK_DRAW_WEIGHT',
    'BOOSTER',
    'BOW_HUNTING_FISH',
    'BOW_HUNTING_STAGE',
    'CAMPAIGNS',
    'CHALLENGE',
    'CHAMPIONSHIPS',
    'CHAMPIONSHIPS_ACTIVITY_PROBABILITY',
    'CHAMPIONSHIPS_LEVEL',
    'CHAMPIONSHIPS_MULTIPLE',
    'CHAMPIONSHIPS_ROAD',
    'CHAMPIONSHIPS_TYPE',
    'CHAT_EMOJI',
    'CHAT_REPLY',
    'CHEST',
    'CHEST_POINT',
    'CLUB_FLAG',
    'CLUB_POSITION',
    'CLUB_PROGRESS_REWARDS',
    'CLUB_PROGRESS_RULES',
    'CLUB_RED_PACKET',
    'CLUB_TAG_LIST',
    'COLLECTION_BASE',
    'COLLECTION_CHAPTER',
    'COLLECTION_ENERGY_COST_DEBUFF',
    'COLLECTION_ENERGY_COST_RECOVER',
    'COLLECTION_EXCHANGE_STORE',
    'COLLECTION_MULTI_MODE_RATE',
    'COLLECTION_PROTECT',
    'COLLECTION_REWARD',
    'COLLECTION_STAR_LEVEL',
    'COLLECTOR',
    'COLLECTOR_BUFF',
    'COLLECTOR_LEVEL',
    'COLLECTOR_TITLE',
    'COMMON_EXCHANGE',
    'COMMON_RANK_REWARD',
    'COMMON_REWARDS',
    'CONTINUOUS_GIFT',
    'COOPERATION_SYS_BOT',
    'COOPERATION_SYS_FINAL_REWARD_WITH_TIME',
    'COOPERATION_SYS_FISHCATCH',
    'COOPERATION_SYS_REWARD',
    'COOPERATION_SYS_ROULETTE',
    'COUNTRY_CITY',
    'CURVE',
    'DIALOG_SEQUENCE',
    'DICE_EVENT_BLOCK',
    'DICE_EVENT_FISHCATCH',
    'DICE_EVENT_RANK',
    'DICE_EVENT_REWARD',
    'DICE_EVENT_UPGRADES',
    'DIVISION_MAIN',
    'DIVISION_REWARDS',
    'DLC_NODES',
    'DRAGON_BOAT_FISHCATCH',
    'DRAGON_BOAT_RANK',
    'DRAGON_BOAT_REWARD',
    'DROP_COUNTER',
    'DROP_ENTITY',
    'DROP_LOGIC',
    'DROP_LOGIC_CONDITION',
    'DROP_MAIN',
    'DROP_NEWBIE',
    'DROP_PACK',
    'DUEL_AI_TIMELINE',
    'DUEL_CARDS',
    'DUEL_EMOJI',
    'DUEL_ENEMY_AREA',
    'DUEL_FAIRNESS_MODE',
    'DUEL_FISH_STATE',
    'DUEL_FISH_STATE_EXTRA',
    'DUEL_FISH_STATE_NUM_WEIGHT',
    'DUEL_INFO_SAMPLING_RANGE',
    'DUEL_LEGENDSARENA',
    'DUEL_MULTIPLIER',
    'DUEL_PLAYER_TYPE',
    'DUEL_RANKING',
    'DUEL_ROBOT',
    'DUEL_ROBOT_ACTION',
    'DUEL_ROBOT_EMOJI_CONDITION',
    'DUEL_ROBOT_GEAR',
    'DUEL_ROBOT_GEAR_SERIES',
    'DUEL_ROBOT_PERSONALITY',
    'DUEL_ROBOT_POINT_STAR',
    'DUEL_ROBOT_POINT_STAR_RANGE',
    'DUEL_ROBOT_SAMPLING_RANGE',
    'DUEL_SCORE_LEVEL',
    'DUEL_SERIES',
    'DUEL_SERIES_MATCH',
    'DUEL_SERIES_REWARDS',
    'DUEL_TOKEN',
    'EFFECT',
    'EFFECT_DROP',
    'EFFECT_GROUP',
    'EFFECT_TYPE',
    'ENUM_MAPPING',
    'EVENT_ENDLESS_SALE',
    'EVENT_ENDLESS_SALE_CONTAINER',
    'EVENT_LOGIN_PACK',
    'EVENT_N_DAY_TASKS_BUFF',
    'EVENT_N_DAY_TASKS_BUFF_FISHCARD_SHOW',
    'EVENT_N_DAY_TASKS_LEADERBOARD',
    'EVENT_N_DAY_TASKS_MILESTONE',
    'EVENT_SPECIAL_SALE',
    'FAKE_DROP',
    'FIREBASE_NOTIFICATION',
    'FISH',
    'FISHCARD',
    'FISHCARD_PACK_INFO',
    'FISHCARD_REWARD_GROUP',
    'FISHCARD_RULES',
    'FISHCARD_SELF_SELECTE',
    'FISHCARD_UP',
    'FISHERIES',
    'FISHERIES_ACTIVITY',
    'FISHERIES_STAR',
    'FISHING_MEDAL_MAIN',
    'FISHING_MEDAL_SHARDS',
    'FISHING_MEDAL_SKILL',
    'FISHING_MEDAL_SLOT',
    'FISHING_MEDAL_STARS',
    'FISHING_RECORD_TYPE',
    'FISHING_ROD',
    'FISHING_ROD_SHARDS',
    'FISHING_ROD_STAR',
    'FISHING_ROD_UP',
    'FISHING_WAIT_TIME',
    'FISH_ACTION',
    'FISH_ACTION_CONDITION',
    'FISH_ACTION_SERIES',
    'FISH_ACTION_USE',
    'FISH_ACTIVITY_SPOT_CONDITION',
    'FISH_ACTIVITY_SPOT_COOLDOWN',
    'FISH_ACTIVITY_SPOT_ENERGY',
    'FISH_ACTIVITY_SPOT_ENERGY_SHOW',
    'FISH_BAG',
    'FISH_CARD_POSSIBILITY',
    'FISH_GOLDEN_SHOW',
    'FISH_POINT',
    'FISH_SCALE',
    'FISH_SCENE_STAR_REWARD_BOX',
    'FISH_SPECIAL_POINT',
    'FISH_SPOT',
    'FISH_STAR_BET_BONUS',
    'FISH_STAR_COMBAT_POWER',
    'FISH_STAR_GRADING',
    'FISH_STAR_PROBABILITY',
    'FISH_STAR_REWARD_BOX',
    'FISH_STATE',
    'FISH_TYPECLASS_VISUAL',
    'FISH_WEIGHT',
    'FISH_WEIGHT_NEW',
    'FISH_WILD',
    'FOLLOW_US',
    'FORMULA',
    'FUND_LEVEL',
    'FUND_MAIN',
    'GIFTPACK_CONDITION',
    'GIFTPACK_GROUP',
    'GIFTPACK_GROUP_CONDITION',
    'GLOBAL_CONST_VALUE',
    'GLOBAL_VALUE',
    'GRADIANT_COST',
    'HIDDEN_TREASURE_EVENT_FISHCATCH',
    'HIDDEN_TREASURE_EVENT_ITEM',
    'HIDDEN_TREASURE_EVENT_PUZZLE',
    'HIDDEN_TREASURE_EVENT_PUZZLE_LEVEL',
    'HIDDEN_TREASURE_EVENT_RANK',
    'HIDDEN_TREASURE_EVENT_REWARD',
    'HOOK_CURVE_PACKAGE',
    'IOS_PROMO_CODE',
    'ITEM_ACCESS_WAYS',
    'ITEM_CONVERSION',
    'ITEM_CONVERT',
    'ITEM_CONVERT_RULE',
    'ITEM_MAIN',
    'ITEM_OLD_RECYCLE',
    'LICENSE_MAIN',
    'LOGIC_TRIGGER_TYPE_MAPPING',
    'LOTTERY_MAIN',
    'LOTTERY_SHOW',
    'MAIL_FISHCARD_PACK',
    'MAIL_MAIN',
    'MATCH_POINT',
    'MERGE_CONFIG',
    'MERGE_FISHCATCH',
    'MERGE_ITEM',
    'MERGE_LEVEL',
    'MERGE_RANK',
    'MINIGAME_HIDDENTREASURE_LAYOUT',
    'MINIGAME_HIDDENTREASURE_LAYOUTMETADATA',
    'MINIGAME_HIDDENTREASURE_LEVEL',
    'MINIGAME_HIDDENTREASURE_TARGET',
    'MISSION_CONDITION',
    'MISSION_GROUP',
    'MISSION_MAIN',
    'MISSION_NEWBIE',
    'MOTION_ACC_TO_DIST',
    'MULTIPLAYER_ROOM_ENUM',
    'NAMES',
    'NBG_FIXED_FISH',
    'NBG_FIXED_RANK',
    'NBG_FIXED_RANK_CHECKPOINT',
    'NEWBIE_NODES',
    'NEW_FISH_AI',
    'NEW_GUIDE_KEY',
    'NEW_PLOT_CHALLENGE_FISH_POOL',
    'NEW_PLOT_CHALLENGE_LEVEL',
    'NEW_PLOT_CLUE',
    'NEW_PLOT_CLUE_REWARD',
    'NEW_PLOT_CLUE_STATE',
    'NEW_PLOT_CLUE_TRIGGER',
    'NEW_PLOT_FISHERIES_STAR',
    'NEW_PLOT_FISH_SPOT',
    'NEW_PLOT_FISH_STAR_COMBAT_POWER',
    'NEW_PLOT_FISH_STAR_COMBAT_SPECIAL',
    'NEW_PLOT_FISH_TYPECLASS_VISUAL',
    'NEW_PLOT_FISH_TYPE_DROP',
    'NEW_PLOT_FIXED_FISH',
    'NEW_PLOT_LEVEL_OVERVIEW',
    'NEW_PLOT_LEVEL_UP',
    'NEW_PLOT_LEVEL_UP_CHASE',
    'NEW_PLOT_MAIN',
    'NEW_PLOT_MAP_MAIN',
    'NEW_PLOT_MAP_POINT',
    'NEW_PLOT_ORDER_PROGRESS_REWARD',
    'NEW_PLOT_POINT_CHASE',
    'NEW_PLOT_PREVIEW',
    'NEW_PLOT_QUEST',
    'NEW_PLOT_SEASON_END',
    'NEW_PLOT_STORY',
    'NUM_WEIGHT',
    'OUTFIT_ACTIONS',
    'OUTFIT_LABEL',
    'OUTFIT_SHOP',
    'OUTFIT_SKIN',
    'OUTFIT_SUIT',
    'OUTWARD',
    'OUT_DRAW_BIG_REWARD',
    'OUT_DRAW_MAIN',
    'OUT_DRAW_SMALL_REWARD',
    'PAYMENT',
    'PAYMENT_BUNDLE_GROUP',
    'PAYMENT_BUNDLE_PACK',
    'PAYMENT_GIFT',
    'PAYMENT_GIFT_GROUP',
    'PAYMENT_MONTH_CARD',
    'PIGGY_BANK',
    'PLAYERCARD_AI',
    'PLAYER_LEVEL_UP',
    'PLAYER_PROFILE_IMAGE',
    'POINT_PROGRESS',
    'POINT_PROGRESS_MULTIPLE',
    'POINT_PROGRESS_NEW_ACT_ORDER',
    'POINT_PROGRESS_NEW_ACT_RULE',
    'POINT_PROGRESS_NEW_PLOT_ORDER',
    'POINT_PROGRESS_REWARD',
    'POINT_PROGRESS_REWARD_ENDLESS',
    'POWER_FISHING_ROD',
    'POWER_FISHING_ROD_STAR',
    'POWER_NEW_PLOT_COLLECTION_CONVERT',
    'POWER_NEW_PLOT_CONVERT',
    'PRESENT',
    'PRIVILEGE_MAIN',
    'PROTECTIVE',
    'PROTECTIVE_2004',
    'PROTECTIVE_3001_BET',
    'PROTECTIVE_3001_CAST',
    'PROTECTIVE_3001_EFFECT',
    'PROTECTIVE_3001_ENERGY',
    'PROTECTIVE_3002_CONST',
    'PROTECTIVE_3002_PURCHASE',
    'PROTECTIVE_6001',
    'PUSH',
    'PUSH_DETAILS',
    'PUSH_NOTIFICATION',
    'QUESTIONNAIRE_NEW',
    'RANKAREA',
    'RANKUPVOTE',
    'RANK_GLOBAL',
    'RANK_HOUSE_RULES',
    'RED_DOT_HOME_MANAGEMENT',
    'REPEATABLE_CHALLENGE',
    'RESOURCE',
    'RESOURCE_CONVERT_AUTO',
    'RESULT_CODE',
    'ROD_SKIN',
    'ROD_TO_FISHERIES_STAR',
    'ROULETTE',
    'SHOP_GOODS',
    'SHOP_GOODS_SEASON_INFO',
    'SHOP_MAIN',
    'SKILL',
    'SKILL_GUIDE',
    'STATISTICAL_TYPE_MAPPING',
    'STORE_SHOW',
    'STORE_SHOW_TAG',
    'TALENT_LEVEL',
    'TALENT_PAGE',
    'TALENT_POINT',
    'THREE_FISH_MAIN',
    'THREE_FISH_RANK_REWARD',
    'TIMER_MAIN',
    'TIPS_TUTORIAL',
    'TOWER_FISHERIES',
    'TOWER_FLOOR',
    'TOWER_LEVEL',
    'TOWER_ORDER',
    'TOWER_STAR_REWARDS',
    'UNIVERSAL_MILESTONE',
    'UNLOCK_SYSTEM',
    'UNLOCK_SYSTEM_NEW_PLOT',
    'VIP',
    'XDAYS_MAIN',
    'XDAYS_RANK',
    'XDAYS_RANK_REWARD',
]

warning_remove_list=[]
for table_key in table_key_list:
    table_data=get_table_data(table_key)
    table_tp_id_name = get_tp_id_name(table_key)
    pos_1=0
    table_data_list=list(table_data.items())
    remove_key_list=[]
    for num in range(len(table_data_list)):
        key,value=table_data_list[num]
        value_list=list(value.items())
        # print(value_list)
        if value_list[1][0]!='id':
            print(value_list)
            raise

        # 检测是第三列 是否存在
        if len(value_list)<4:
            remove_key_list.append(num)
            continue
        else:
            # 检测id一致性,不一致，则删除
            if value_list[3][0]!=table_tp_id_name:
                remove_key_list.append(num)
                continue
        if value_list[1][1]!=value_list[3][1]:
            # 不一致，需要统一, 赋值
            value_list[1]=(value_list[1][0],value_list[3][1])
            table_data_list[num]=(value_list[3][1],dict(value_list))

    if len(remove_key_list)>0:
        for remove_key in reversed(remove_key_list):
            # 从大到小移除，避免乱序
            table_data_list.pop(remove_key)
        warning_remove_list.append(table_key)

    table_data=dict(table_data_list)
    write_table_data(table_key, table_data)
    print('finish：'+table_key)
print(warning_remove_list)






